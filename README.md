# Проект Text Formatter

## Обзор
Это веб-приложение, разработанное на Django, предназначено для создания, редактирования и удаления текстовых записей. Оно поддерживает асинхронный подсчет слов с использованием Celery, Redis и микросервиса на FastAPI. Приложение включает аутентификацию пользователей, современный интерфейс с редактором TinyMCE и модульные тесты для надежности.

### Возможности
- Создание, редактирование и удаление текстовых записей.
- Аутентификация пользователей (вход/выход).
- Асинхронный подсчет слов через микросервис FastAPI.
- Адаптивный дизайн с анимациями CSS.
- Модульные тесты для основного функционала.

## Требования
Перед запуском проекта убедитесь, что у вас установлены следующие компоненты:
- Python 3.9 или выше
- Redis (для Celery)
- Git (опционально, для клонирования)
- pip (менеджер пакетов Python)

## Инструкция по установке

### 1. Клонирование репозитория (опционально)
Если проект находится в Git-репозитории, выполните:
```bash
git clone <URL-репозитория>
```

### 2. Установка зависимостей
Установите необходимые Python-пакеты:
```bash
pip install -r requirements.txt
```
**Примечание**: Если файл `requirements.txt` отсутствует, установите зависимости вручную:
```bash
pip install django celery redis fastapi uvicorn requests
```

### 3. Настройка Django
- Убедитесь, что база данных настроена (по умолчанию используется SQLite).
- Выполните миграции:
  ```bash
  python3 manage.py makemigrations
  python3 manage.py migrate
  ```
- Создайте суперпользователя для доступа к админ-панели (опционально):
  ```bash
  python3 manage.py createsuperuser
  ```

### 4. Запуск сервисов
Проект состоит из нескольких сервисов, которые должны работать одновременно. Откройте отдельные терминалы для каждого.

#### 4.1. Redis (брокер сообщений для Celery)
```bash
redis-server
```
- Проверьте работоспособность:
  ```bash
  redis-cli ping
  ```
  Ожидаемый результат: `PONG`

#### 4.2. Celery (асинхронная обработка задач)
```bash
celery -A main_service worker -l info
```
- Убедитесь, что Celery подключился к Redis (проверьте логи на наличие строки `Connected to redis://localhost:6379/0`).

#### 4.3. FastAPI (микросервис для подсчета слов)
- Перейдите в директорию с файлом `main.py` (если он находится отдельно).
- Запустите FastAPI:
  ```bash
  uvicorn main:app --reload --host 0.0.0.0 --port 8001
  ```
- Проверьте микросервис:
  ```bash
  curl -X POST http://localhost:8001/count_words -H "Content-Type: application/json" -d '{"content": "Это тест"}'
  ```
  Ожидаемый результат: `{"word_count": 2}`

#### 4.4. Django (основной веб-сервер)
```bash
python3 manage.py runserver 0.0.0.0:8000
```
- Откройте `http://localhost:8000/` в браузере, чтобы убедиться, что сервер работает.

### 5. Проверка функционала
1. Зарегистрируйтесь или войдите через `/accounts/login/`.
2. Создайте текст на `/create/`.
3. Убедитесь, что количество слов (`word_count`) обновляется (через несколько секунд из-за асинхронного подсчета).
4. Отредактируйте текст на `/edit/<id>/` и проверьте, что `word_count` также обновляется.
5. Для проверки админ-панели (опционально): перейдите на `/admin/` и войдите с учетной записью суперпользователя.

## Устранение неполадок
- **Redis не запускается**: Проверьте, свободен ли порт 6379 (`lsof -i :6379`) и завершите конфликтующий процесс (`kill -9 <PID>`).
- **Celery не обновляет `word_count`**: Убедитесь, что Redis и FastAPI запущены, и просмотрите логи Celery.
- **FastAPI возвращает 404**: Проверьте, что маршрут `/count_words` определен в `main.py`.
- **Ошибка подключения к порту**: Убедитесь, что все сервисы используют правильные порты (8000 для Django, 8001 для FastAPI, 6379 для Redis).

## Дополнительно
- Проект включает модульные тесты. Выполните их:
  ```bash
  python3 manage.py test
  ```
- Для контейнеризации проекта можно настроить Docker (инструкции будут добавлены позже).

## Контакты
Если возникнут вопросы, свяжитесь с разработчиком: [укажите email или ссылку на профиль].